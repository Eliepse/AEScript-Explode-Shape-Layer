function consLog(e){configs.log&&$.writeln(e)}function listMatchNames(e){for(var o=1;o<=e.numProperties;o++){var r=e.property(o);consLog(r.matchName+"("+r.name+")")}}function explodeLayer(e){consLog("==============\n==============");var o=e.property("Contents"),r=[];if(!(o.numProperties>configs.itemAmountWarning)||confirm("You have more than "+configs.itemAmountWarning+" elements. Execution time might be long, are you sure you want to continue ?")){for(c=o.numProperties;c>0;c--){var t=o.property(c);if(t.enabled){var p=emptyDuplicateLayer(e);p.name=e.name+" - "+t.name,p.enabled=!1,r.push(p),p.property("Contents").canAddProperty(t.matchName)&&copyProperties(t,p.property("Contents").addProperty(t.matchName),"")}}for(var c=0;c<r.length;c++)r[c].enabled=!0}}function explode(){if(app.project.activeItem.selectedLayers.length>1)alert("Select a single shape layer");else{var e=app.project.activeItem.selectedLayers[0];void 0!=e&&"ADBE Vector Layer"===e.matchName?explodeLayer(e):alert("Select a shape layer")}}function emptyDuplicateLayer(e){var o=e.containingComp.layers.addShape();return copyProperty("anchorPoint",e,o),copyProperty("position",e,o),copyProperty("scale",e,o),copyProperty("rotation",e,o),copyProperty("opacity",e,o),o}function copyProperties(e,o,r){for(var t=1;t<=e.numProperties;t++){var p=e.property(t);if(!p.enabled||!o.canAddProperty(p.matchName))return;consLog(r+p.matchName);var c=o.addProperty(p.matchName);switch(p.matchName){case"ADBE Vector Filter - Merge":copyProperty("mode",p,c);break;case"ADBE Vector Materials Group":consLog(r+"-- skipped");break;case"ADBE Vector Graphic - Stroke":copyPropertyStroke(p,c);break;case"ADBE Vector Graphic - Fill":copyPropertyFill(p,c);break;case"ADBE Vector Transform Group":copyPropertyTransform(p,c);break;case"ADBE Vector Shape - Rect":copyPropertyRect(p,c);break;case"ADBE Vector Shape - Ellipse":copyPropertyEllipse(p,c);break;case"ADBE Vector Shape - Star":copyPropertyStar(p,c);break;case"ADBE Root Vectors Group":case"ADBE Vectors Group":case"ADBE Vector Group":copyProperties(p,c,r+="    ");break;case"ADBE Vector Shape - Group":copyPropertyShape(p,c);break;case"ADBE Vector Blend Mode":c.setValue(p.value)}}}function copyProperty(e,o,r){r[e].setValue(o[e].value)}function copyPropertyShape(e,o){o.property("ADBE Vector Shape").setValue(e.property("ADBE Vector Shape").value)}function copyPropertyStroke(e,o){copyProperty("composite",e,o),copyProperty("color",e,o),copyProperty("strokeWidth",e,o),copyProperty("lineCap",e,o),copyProperty("lineJoin",e,o),copyProperty("miterLimit",e,o)}function copyPropertyFill(e,o){copyProperty("composite",e,o),copyProperty("fillRule",e,o),copyProperty("color",e,o)}function copyPropertyTransform(e,o){copyProperty("anchorPoint",e,o),copyProperty("position",e,o),copyProperty("scale",e,o),copyProperty("skew",e,o),copyProperty("skewAxis",e,o),copyProperty("rotation",e,o),copyProperty("opacity",e,o)}function copyPropertyRect(e,o){copyProperty("shapeDirection",e,o),copyProperty("size",e,o),copyProperty("position",e,o),copyProperty("roundness",e,o)}function copyPropertyEllipse(e,o){copyProperty("shapeDirection",e,o),copyProperty("size",e,o),copyProperty("position",e,o)}function copyPropertyStar(e,o){copyProperty("shapeDirection",e,o),copyProperty("type",e,o),copyProperty("points",e,o),copyProperty("position",e,o),copyProperty("rotation",e,o),copyProperty("innerRadius",e,o),copyProperty("outerRadius",e,o),copyProperty("innerRoundness",e,o),copyProperty("outerRoundness",e,o)}function createUI(e){if(e instanceof Panel);else{var o=new Window("palette",configs.title,void 0,{resizeable:!0});o.show()}var r=o.add("button",[10,10,100,30],"Explode layer");return o.text=configs.title,o.bounds.width=120,o.bounds.height=40,r.onClick=function(){var e=(new Date).getTime();explode();var o=(new Date).getTime()-e;consLog("Execution time : "+Math.floor(o/1e3)+"s "+o%1e3+"ms")},o}var configs={title:"Explode layer tool",log:!0,itemAmountWarning:50},_panel=createUI(this);